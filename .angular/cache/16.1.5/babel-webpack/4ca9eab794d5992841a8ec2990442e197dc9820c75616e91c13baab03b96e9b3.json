{"ast":null,"code":"import { BehaviorSubject, map } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"ngx-webstorage\";\nexport class LoginService {\n  constructor(http, localStorageService) {\n    this.http = http;\n    this.localStorageService = localStorageService;\n    this.apiUrl = `http://localhost:8080/api/auth`;\n    const storedUser = localStorage.getItem('user');\n    this.userSubject = new BehaviorSubject(storedUser ? JSON.parse(storedUser) : null);\n    this.user = this.userSubject.asObservable();\n  }\n  register(registerData) {\n    const registerUrl = `${this.apiUrl}/register`;\n    return this.http.post(registerUrl, registerData);\n  }\n  login(loginPayload) {\n    return this.http.post(this.apiUrl + '/login', loginPayload).pipe(map(data => {\n      this.localStorageService.store('authenticationToken', data.token);\n      this.localStorageService.store('user', data.user);\n      this.userSubject.next(data.user); // Update the userSubject with the logged-in user\n      console.log(data.user);\n      return true;\n    }));\n  }\n}\nLoginService.ɵfac = function LoginService_Factory(t) {\n  return new (t || LoginService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.LocalStorageService));\n};\nLoginService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: LoginService,\n  factory: LoginService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"names":["BehaviorSubject","map","LoginService","constructor","http","localStorageService","apiUrl","storedUser","localStorage","getItem","userSubject","JSON","parse","user","asObservable","register","registerData","registerUrl","post","login","loginPayload","pipe","data","store","token","next","console","log","i0","ɵɵinject","i1","HttpClient","i2","LocalStorageService","factory","ɵfac","providedIn"],"sources":["C:\\Users\\hp\\coChat\\src\\app\\services\\login.service.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable, map } from 'rxjs';\nimport { LocalStorageService } from 'ngx-webstorage';\n\nexport interface RegisterData {\n  userName: string;\n  userMail: string;\n  userPassword: string;\n}\n\nexport interface AuthData {\n  userMail: string;\n  userPassword: string;\n}\n\nexport interface AuthenticationResponse {\n  token: string;\n  message: string;\n  user: AuthData;\n  // Other properties if needed\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class LoginService {\n  private apiUrl = `http://localhost:8080/api/auth`;\n  private userSubject: BehaviorSubject<AuthData | null>;\n  public user: Observable<AuthData | null>;\n\n  constructor(private http: HttpClient, private localStorageService: LocalStorageService) {\n    const storedUser = localStorage.getItem('user');\n    this.userSubject = new BehaviorSubject<AuthData | null>(storedUser ? JSON.parse(storedUser) : null);\n    this.user = this.userSubject.asObservable();\n  }\n\n  register(registerData: RegisterData): Observable<AuthenticationResponse> {\n    const registerUrl = `${this.apiUrl}/register`;\n    return this.http.post<AuthenticationResponse>(registerUrl, registerData);\n  }\n\n  login(loginPayload: AuthData): Observable<boolean> {\n    return this.http.post<AuthenticationResponse>(this.apiUrl + '/login', loginPayload).pipe(\n      map(data => {\n        this.localStorageService.store('authenticationToken', data.token);\n        this.localStorageService.store('user', data.user);\n        this.userSubject.next(data.user); // Update the userSubject with the logged-in user\n        console.log(data.user);\n        return true;\n      })\n    );\n  }\n}\n"],"mappings":"AAEA,SAASA,eAAe,EAAcC,GAAG,QAAQ,MAAM;;;;AAwBvD,OAAM,MAAOC,YAAY;EAKvBC,YAAoBC,IAAgB,EAAUC,mBAAwC;IAAlE,KAAAD,IAAI,GAAJA,IAAI;IAAsB,KAAAC,mBAAmB,GAAnBA,mBAAmB;IAJzD,KAAAC,MAAM,GAAG,gCAAgC;IAK/C,MAAMC,UAAU,GAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;IAC/C,IAAI,CAACC,WAAW,GAAG,IAAIV,eAAe,CAAkBO,UAAU,GAAGI,IAAI,CAACC,KAAK,CAACL,UAAU,CAAC,GAAG,IAAI,CAAC;IACnG,IAAI,CAACM,IAAI,GAAG,IAAI,CAACH,WAAW,CAACI,YAAY,EAAE;EAC7C;EAEAC,QAAQA,CAACC,YAA0B;IACjC,MAAMC,WAAW,GAAG,GAAG,IAAI,CAACX,MAAM,WAAW;IAC7C,OAAO,IAAI,CAACF,IAAI,CAACc,IAAI,CAAyBD,WAAW,EAAED,YAAY,CAAC;EAC1E;EAEAG,KAAKA,CAACC,YAAsB;IAC1B,OAAO,IAAI,CAAChB,IAAI,CAACc,IAAI,CAAyB,IAAI,CAACZ,MAAM,GAAG,QAAQ,EAAEc,YAAY,CAAC,CAACC,IAAI,CACtFpB,GAAG,CAACqB,IAAI,IAAG;MACT,IAAI,CAACjB,mBAAmB,CAACkB,KAAK,CAAC,qBAAqB,EAAED,IAAI,CAACE,KAAK,CAAC;MACjE,IAAI,CAACnB,mBAAmB,CAACkB,KAAK,CAAC,MAAM,EAAED,IAAI,CAACT,IAAI,CAAC;MACjD,IAAI,CAACH,WAAW,CAACe,IAAI,CAACH,IAAI,CAACT,IAAI,CAAC,CAAC,CAAC;MAClCa,OAAO,CAACC,GAAG,CAACL,IAAI,CAACT,IAAI,CAAC;MACtB,OAAO,IAAI;IACb,CAAC,CAAC,CACH;EACH;;AA1BWX,YAAY,C;mBAAZA,YAAY,EAAA0B,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,mBAAA;AAAA;AAAZ/B,YAAY,C;SAAZA,YAAY;EAAAgC,OAAA,EAAZhC,YAAY,CAAAiC,IAAA;EAAAC,UAAA,EAFX;AAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}