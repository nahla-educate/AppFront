{"ast":null,"code":"import { HttpHeaders } from '@angular/common/http';\nimport { BehaviorSubject, map } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"ngx-webstorage\";\nexport class AuthData {}\nexport class LoginService {\n  constructor(http, localStorageService) {\n    this.http = http;\n    this.localStorageService = localStorageService;\n    this.apiUrl = `http://localhost:8080/api/auth`;\n    this.token = null;\n    const storedUser = localStorage.getItem('user');\n    this.userSubject = new BehaviorSubject(storedUser ? JSON.parse(storedUser) : null);\n    this.user = this.userSubject.asObservable();\n  }\n  setToken(token) {\n    this.token = token;\n  }\n  getHeaders() {\n    let headers = new HttpHeaders();\n    if (this.token) {\n      headers = headers.set('Authorization', `Bearer ${this.token}`);\n    }\n    return headers;\n  }\n  register(registerData) {\n    const registerUrl = `${this.apiUrl}/signup`;\n    return this.http.post(registerUrl, registerData);\n  }\n  authenticate(authenticationRequest) {\n    return this.http.post(`${this.apiUrl}/authenticate`, authenticationRequest);\n  }\n  loginyes(data) {\n    console.log(\"I'am server\");\n    return this.http.post(`${this.apiUrl}/login`, data);\n  }\n  login(loginPayload) {\n    return this.http.post(this.apiUrl + '/login', loginPayload).pipe(map(data => {\n      this.localStorageService.store('authenticationToken', data.token);\n      this.localStorageService.store('user', data.user);\n      this.userSubject.next(data.user); // Update the userSubject with the logged-in user\n      console.log(data.user);\n      return true;\n    }));\n  }\n}\nLoginService.ɵfac = function LoginService_Factory(t) {\n  return new (t || LoginService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.LocalStorageService));\n};\nLoginService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: LoginService,\n  factory: LoginService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"names":["HttpHeaders","BehaviorSubject","map","AuthData","LoginService","constructor","http","localStorageService","apiUrl","token","storedUser","localStorage","getItem","userSubject","JSON","parse","user","asObservable","setToken","getHeaders","headers","set","register","registerData","registerUrl","post","authenticate","authenticationRequest","loginyes","data","console","log","login","loginPayload","pipe","store","next","i0","ɵɵinject","i1","HttpClient","i2","LocalStorageService","factory","ɵfac","providedIn"],"sources":["C:\\Users\\hp\\coChat\\src\\app\\services\\login.service.ts"],"sourcesContent":["import { HttpClient, HttpHeaders } from '@angular/common/http';\nimport { Injectable } from '@angular/core';\nimport { BehaviorSubject, Observable, map } from 'rxjs';\nimport { LocalStorageService } from 'ngx-webstorage';\n\nexport interface RegisterData {\n\n  userMail: string;\n  userPassword: string;\n}\n\nexport class AuthData {\n  userMail: string | undefined;\n  userPassword: string | undefined;\n}\n\nexport interface AuthenticationResponse {\n  token: string;\n  message: string;\n  user: AuthData;\n  // Other properties if needed\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class LoginService {\n  private apiUrl = `http://localhost:8080/api/auth`;\n  private userSubject: BehaviorSubject<AuthData | null>;\n  public user: Observable<AuthData | null>;\n  private token: string | null = null;\n\n  constructor(private http: HttpClient, private localStorageService: LocalStorageService) {\n    const storedUser = localStorage.getItem('user');\n    this.userSubject = new BehaviorSubject<AuthData | null>(storedUser ? JSON.parse(storedUser) : null);\n    this.user = this.userSubject.asObservable();\n  }\n\n  setToken(token: string): void {\n    this.token = token;\n  }\n\n  getHeaders(): HttpHeaders {\n    let headers = new HttpHeaders();\n    if (this.token) {\n      headers = headers.set('Authorization', `Bearer ${this.token}`);\n    }\n    return headers;\n  }\n\n  register(registerData: RegisterData): Observable<AuthenticationResponse> {\n    const registerUrl = `${this.apiUrl}/signup`;\n    return this.http.post<AuthenticationResponse>(registerUrl, registerData);\n  }\n\n  authenticate(authenticationRequest: any): Observable<any> {\n    return this.http.post<any>(`${this.apiUrl}/authenticate`, authenticationRequest);\n  }\n  \n\n  loginyes(data: any):Observable<any>{\n    console.log(\"I'am server\");\n    return this.http.post(`${this.apiUrl}/login`, data);\n  }\n\n  login(loginPayload: AuthData): Observable<boolean> {\n    return this.http.post<AuthenticationResponse>(this.apiUrl + '/login', loginPayload).pipe(\n      map(data => {\n        this.localStorageService.store('authenticationToken', data.token);\n        this.localStorageService.store('user', data.user);\n        this.userSubject.next(data.user); // Update the userSubject with the logged-in user\n        console.log(data.user);\n        return true;\n      })\n    );\n  }\n}\n"],"mappings":"AAAA,SAAqBA,WAAW,QAAQ,sBAAsB;AAE9D,SAASC,eAAe,EAAcC,GAAG,QAAQ,MAAM;;;;AASvD,OAAM,MAAOC,QAAQ;AAerB,OAAM,MAAOC,YAAY;EAMvBC,YAAoBC,IAAgB,EAAUC,mBAAwC;IAAlE,KAAAD,IAAI,GAAJA,IAAI;IAAsB,KAAAC,mBAAmB,GAAnBA,mBAAmB;IALzD,KAAAC,MAAM,GAAG,gCAAgC;IAGzC,KAAAC,KAAK,GAAkB,IAAI;IAGjC,MAAMC,UAAU,GAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;IAC/C,IAAI,CAACC,WAAW,GAAG,IAAIZ,eAAe,CAAkBS,UAAU,GAAGI,IAAI,CAACC,KAAK,CAACL,UAAU,CAAC,GAAG,IAAI,CAAC;IACnG,IAAI,CAACM,IAAI,GAAG,IAAI,CAACH,WAAW,CAACI,YAAY,EAAE;EAC7C;EAEAC,QAAQA,CAACT,KAAa;IACpB,IAAI,CAACA,KAAK,GAAGA,KAAK;EACpB;EAEAU,UAAUA,CAAA;IACR,IAAIC,OAAO,GAAG,IAAIpB,WAAW,EAAE;IAC/B,IAAI,IAAI,CAACS,KAAK,EAAE;MACdW,OAAO,GAAGA,OAAO,CAACC,GAAG,CAAC,eAAe,EAAE,UAAU,IAAI,CAACZ,KAAK,EAAE,CAAC;;IAEhE,OAAOW,OAAO;EAChB;EAEAE,QAAQA,CAACC,YAA0B;IACjC,MAAMC,WAAW,GAAG,GAAG,IAAI,CAAChB,MAAM,SAAS;IAC3C,OAAO,IAAI,CAACF,IAAI,CAACmB,IAAI,CAAyBD,WAAW,EAAED,YAAY,CAAC;EAC1E;EAEAG,YAAYA,CAACC,qBAA0B;IACrC,OAAO,IAAI,CAACrB,IAAI,CAACmB,IAAI,CAAM,GAAG,IAAI,CAACjB,MAAM,eAAe,EAAEmB,qBAAqB,CAAC;EAClF;EAGAC,QAAQA,CAACC,IAAS;IAChBC,OAAO,CAACC,GAAG,CAAC,aAAa,CAAC;IAC1B,OAAO,IAAI,CAACzB,IAAI,CAACmB,IAAI,CAAC,GAAG,IAAI,CAACjB,MAAM,QAAQ,EAAEqB,IAAI,CAAC;EACrD;EAEAG,KAAKA,CAACC,YAAsB;IAC1B,OAAO,IAAI,CAAC3B,IAAI,CAACmB,IAAI,CAAyB,IAAI,CAACjB,MAAM,GAAG,QAAQ,EAAEyB,YAAY,CAAC,CAACC,IAAI,CACtFhC,GAAG,CAAC2B,IAAI,IAAG;MACT,IAAI,CAACtB,mBAAmB,CAAC4B,KAAK,CAAC,qBAAqB,EAAEN,IAAI,CAACpB,KAAK,CAAC;MACjE,IAAI,CAACF,mBAAmB,CAAC4B,KAAK,CAAC,MAAM,EAAEN,IAAI,CAACb,IAAI,CAAC;MACjD,IAAI,CAACH,WAAW,CAACuB,IAAI,CAACP,IAAI,CAACb,IAAI,CAAC,CAAC,CAAC;MAClCc,OAAO,CAACC,GAAG,CAACF,IAAI,CAACb,IAAI,CAAC;MACtB,OAAO,IAAI;IACb,CAAC,CAAC,CACH;EACH;;AAjDWZ,YAAY,C;mBAAZA,YAAY,EAAAiC,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,mBAAA;AAAA;AAAZtC,YAAY,C;SAAZA,YAAY;EAAAuC,OAAA,EAAZvC,YAAY,CAAAwC,IAAA;EAAAC,UAAA,EAFX;AAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}